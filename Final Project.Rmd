---
title: "Untitled"
author: "DeVon Marquette Gardner"
date: "12/15/2017"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("ggplot2")
library("dplyr")
library("Hmisc")
library("CARS")
library("leaps")
library("rms")
library('car')
```



```{r}
Worldbank <- read.csv('C3 Worldbank.csv')




Worldbank$Agricultural.land<-as.character(Worldbank$Agricultural.land)
Worldbank$Agriculture <- as.character(Worldbank$Agriculture)
Worldbank$CO2.emissions <- as.character(Worldbank$CO2.emissions)
Worldbank$Exports.of.goods.and.services <- as.character(Worldbank$Exports.of.goods.and.services)
Worldbank$Fertility.rate <- as.character(Worldbank$Fertility.rate)
Worldbank$Fixed.line.and.mobile.phone <- as.character(Worldbank$Fixed.line.and.mobile.phone)
Worldbank$Foreign.direct.investment <- as.character(Worldbank$Foreign.direct.investment)
Worldbank$GDP <- as.character(Worldbank$GDP)
Worldbank$GDP.growth <- as.character(Worldbank$GDP.growth)
Worldbank$GNI.per.capita <- as.character(Worldbank$GNI.per.capita)
Worldbank$GNI <- as.character(Worldbank$GNI)
Worldbank$Gross.capital.formation <- as.character(Worldbank$Gross.capital.formation)
Worldbank$Immunization..measles. <- as.character(Worldbank$Immunization..measles.)
Worldbank$Imports.of.goods.and.services <- as.character(Worldbank$Imports.of.goods.and.services)
Worldbank$Industry <- as.character(Worldbank$Industry)
Worldbank$Inflation <- as.character(Worldbank$Inflation)
Worldbank$Internet.users <- as.character(Worldbank$Internet.users)
Worldbank$Life.expectancy <- as.character(Worldbank$Life.expectancy)
Worldbank$Long.term.debt <- as.character(Worldbank$Long.term.debt)
Worldbank$Merchandise.trade <- as.character(Worldbank$Merchandise.trade)
Worldbank$Military.expenditure <- as.character(Worldbank$Military.expenditure)
Worldbank$Net.barter <- as.character(Worldbank$Net.barter)
Worldbank$Personal.computers <- as.character(Worldbank$Personal.computers)
Worldbank$Services <- as.character(Worldbank$Services)
Worldbank$Short.term.debt <- as.character(Worldbank$Short.term.debt)
Worldbank$ln.GNI <- as.character(Worldbank$ln.GNI)
Worldbank$pop.area <- as.character(Worldbank$pop.area)


```


```{r}
Worldbank$Agricultural.land<-as.numeric(Worldbank$Agricultural.land)
Worldbank$Agriculture <- as.numeric(Worldbank$Agriculture)
Worldbank$CO2.emissions <- as.numeric(Worldbank$CO2.emissions)
Worldbank$Exports.of.goods.and.services <- as.numeric(Worldbank$Exports.of.goods.and.services)
Worldbank$Fertility.rate <- as.numeric(Worldbank$Fertility.rate)
Worldbank$Fixed.line.and.mobile.phone <- as.numeric(Worldbank$Fixed.line.and.mobile.phone)
Worldbank$Foreign.direct.investment <- as.numeric(Worldbank$Foreign.direct.investment)
Worldbank$GDP <- as.numeric(Worldbank$GDP)
Worldbank$GDP.growth <- as.numeric(Worldbank$GDP.growth)
Worldbank$GNI.per.capita <- as.numeric(Worldbank$GNI.per.capita)
Worldbank$GNI <- as.numeric(Worldbank$GNI)
Worldbank$Gross.capital.formation <- 
as.numeric(Worldbank$Gross.capital.formation)
Worldbank$Immunization..measles. <- as.numeric(Worldbank$Immunization..measles.)
Worldbank$Imports.of.goods.and.services <- as.numeric(Worldbank$Imports.of.goods.and.services)
Worldbank$Industry <- as.numeric(Worldbank$Industry)
Worldbank$Inflation <- as.numeric(Worldbank$Inflation)
Worldbank$Internet.users <- as.numeric(Worldbank$Internet.users)
Worldbank$Life.expectancy <- as.numeric(Worldbank$Life.expectancy)
Worldbank$Long.term.debt <- as.numeric(Worldbank$Long.term.debt)
Worldbank$Merchandise.trade <- as.numeric(Worldbank$Merchandise.trade)
Worldbank$Military.expenditure <- as.numeric(Worldbank$Military.expenditure)
Worldbank$Net.barter <- as.numeric(Worldbank$Net.barter)
Worldbank$Personal.computers <- as.numeric(Worldbank$Personal.computers)
Worldbank$Services <- as.numeric(Worldbank$Services)
Worldbank$Short.term.debt <- as.numeric(Worldbank$Short.term.debt)
Worldbank$ln.GNI <- as.numeric(Worldbank$ln.GNI)
Worldbank$pop.area <- as.numeric(Worldbank$pop.area)

Worldbank <- na.omit(Worldbank)



```


```{r}
null <- lm(GDP.growth~1,data = Worldbank) # stepwise
full <- lm(GDP.growth~. ,data = Worldbank) # stepwise
step(null, scope=list(lower=null, upper=full),direction="forward")
```

```{r}
d <- lm(formula = GDP.growth ~ Foreign.direct.investment + Population + 
    Official.development.assistance + Inflation + Gross.capital.formation + 
    Immunization..measles. + Agricultural.land + Exports.of.goods.and.services + 
    Life.expectancy + Industry, data = Worldbank)

summary(d)

ggplot(d, aes(x =  Foreign.direct.investment + Population + 
    Official.development.assistance + Inflation + Gross.capital.formation + 
    Immunization..measles. + Agricultural.land + Exports.of.goods.and.services + 
    Life.expectancy + Industry , y = GDP.growth)) +
  geom_point() + stat_smooth(method="lm",formula=y ~ poly(x, 1, raw=TRUE),colour="red")

Worldbank_mod1_reg1 <- d$res

plot(Worldbank_mod1_reg1)

hist(Worldbank_mod1_reg1)

qqnorm(Worldbank_mod1_reg1)

summary(Worldbank_mod1_reg1)

shapiro.test(Worldbank_mod1_reg1)

ncvTest(d)

confint(d, "Industry", level = 0.95)

confint(d, "Gross.capital.formation", level = 0.95)
```
This was the model that was produced by the stepwise regression analysis. It includes  the following predictors: Foreign. direct investment, Population, Official.development.assistance, Inflation, Gross.capital.formation,Immunization..measles., Agricultural.land, Exports.of.goods.and.services, Life expectancy and Industry.Each of these predictors had a coefficient value that was less than 0.05 which means that they are all statistically signifigant. I created a linear model with these predictors predicting the GDP.growth. Plot wise, the historgram of the residuals displays an normal distribution. The residual plot suggests that they points are random and show no signs of autocorrelation nor hetero skedasticity. My linear model yielded a value of 0.80 for the adjusted R^2 squared term which shows that the model is a good fit for the line represents 80% of the data. When conducting both my Shapiro-Wilk and NCV tests, I yielded high p-values being 0.7776 and 0.8411 respectively, which suggest that the data is normal and not heteroskedastic. 

Now looking at the confidence intervals I see that zero is not in the 95% confidence range for both variables. Because of this it shows that they are statistically signifigant in our model. For Industry, we are 95% sure that it falls between 0.0024 and 0.24. For  Gross capital formation we are 95% confident that it falls between -0.418 to -0.0960. This means that Gross capital formation drops between -0.418 and -0.0960 for every unit increase in GDP.growth. 

```{r}
ggplot(d, aes(x = (Foreign.direct.investment + Population + 
    Official.development.assistance + Inflation + Gross.capital.formation + 
    Immunization..measles. + Agricultural.land + Exports.of.goods.and.services + 
    Life.expectancy + Industry)^2 , y = GDP.growth)) +
  geom_point() + stat_smooth(method="lm",formula=y ~ poly(x, 1, raw=TRUE),colour="red")

b<-lm(formula = GDP.growth ~ sqrt(Foreign.direct.investment + Population + 
    Official.development.assistance + Inflation + Gross.capital.formation + 
    Immunization..measles. + Agricultural.land + Exports.of.goods.and.services + 
    Life.expectancy + Industry)^2, data = Worldbank)

summary(b)

Worldbank_mod2_reg2 <- b$res

hist(Worldbank_mod2_reg2)

qqnorm(Worldbank_mod2_reg2)

summary(Worldbank_mod2_reg2)

ncvTest(b)

shapiro.test(Worldbank_mod2_reg2)

plot(Worldbank_mod2_reg2)



```
This was the model that was produced by the stepwise regression analysis. It includes  the following predictors: Foreign. direct investment, Population, Official.development.assistance, Inflation, Gross.capital.formation,Immunization..measles., Agricultural.land, Exports.of.goods.and.services, Life expectancy and Industry. I created a linear model with these predictors and squared all of them predicting the GDP.growth. I wanted to observe if adding the squared term would help my model. Plot wise, the historgram of the residuals displays an normal distribution. The residual plot suggests that they points are random and show no signs of autocorrelation nor hetero skedasticity but they are also overdisperesed being outside of the range -2 to 2. My linear model yielded a value of 0.29 for the adjusted R^2 squared term which shows that the model is a good fit for the line represents 29% of the data. However, this is not nearly as good as my first model. When conducting both my Shapiro-Wilk and NCV tests, I yielded high p-values being 0.22 and 0.06 respectively, which suggest that the data is normal and not heteroskedastic. Still my p-values are lower than the original model, which suggests the previous is better. 
NO AUTOCORRELATION.

```{r}
ggplot(d, aes(x =  log(Foreign.direct.investment + Population + 
    Official.development.assistance + Inflation + Gross.capital.formation + 
    Immunization..measles. + Agricultural.land + Exports.of.goods.and.services + 
    Life.expectancy + Industry) , y = GDP.growth)) +
  geom_point() + stat_smooth(method="lm",formula=y ~ poly(x, 1, raw=TRUE),colour="red")


c <- lm(formula = GDP.growth ~ log(Foreign.direct.investment + Population + 
    Official.development.assistance + Inflation + Gross.capital.formation + 
    Immunization..measles. + Agricultural.land + Exports.of.goods.and.services + 
    Life.expectancy + Industry), data = Worldbank)

 summary(c)
 
Worldbank_mod1_reg1 <- c$res

plot(Worldbank_mod1_reg1)

hist(Worldbank_mod1_reg1)

qqnorm(Worldbank_mod1_reg1)

summary(Worldbank_mod1_reg1)

ncvTest(c) 

shapiro.test(Worldbank_mod1_reg1) 


```

This was the model that was produced by the stepwise regression analysis. It includes  the following predictors: Foreign. direct investment, Population, Official.development.assistance, Inflation, Gross.capital.formation,Immunization..measles., Agricultural.land, Exports.of.goods.and.services, Life expectancy and Industry. I created a linear model with these predictors and took the log of all of them to predict the GDP.growth. I wanted to observe if logging them the explanatory variables would help my model. Plot wise, the historgram of the residuals displays an normal distribution. The residual plot suggests that they points are random and show no signs of autocorrelation nor hetero skedasticity but they are also overdisperesed being outside of the range -2 to 2, and have a few outliers. My linear model yielded a value of 0.2673 for the adjusted R^2 squared term which shows that the model is a good fit for the line represents 26% of the data. However, this is not nearly as good as my first model. When conducting both my Shapiro-Wilk and NCV tests, I yielded high p-values being 0.42 and 0.21 respectively, which suggest that the data is normal and not heteroskedastic. Still my p-values are lower than the original model, that the first linear model "d" is the best fit for my data. Also this one is better than "b" which is the plot with the sqared terms.

```{r}
e <- lm(formula = GDP.growth ~ (Foreign.direct.investment + Population + 
    Official.development.assistance + Inflation + Gross.capital.formation + 
    Immunization..measles. + Agricultural.land + Exports.of.goods.and.services + 
    Life.expectancy + Industry) * Foreign.direct.investment, data = Worldbank)

summary(e)

ggplot(e, aes(x =  (Foreign.direct.investment + Population + 
    Official.development.assistance + Inflation + Gross.capital.formation + 
    Immunization..measles. + Agricultural.land + Exports.of.goods.and.services + 
    Life.expectancy + Industry) * Foreign.direct.investment , y = GDP.growth)) +
  geom_point() + stat_smooth(method="lm",formula=y ~ poly(x, 1, raw=TRUE),colour="red")

Worldbank_mod3_reg3 <- e$res

plot(Worldbank_mod3_reg3)

hist(Worldbank_mod3_reg3)

qqnorm(Worldbank_mod3_reg3)

summary(Worldbank_mod3_reg3)

shapiro.test(Worldbank_mod3_reg3)

ncvTest(e)

confint(d, "Foreign.dirct.investment", level = 0.95)
```

This was the model that was produced by the stepwise regression analysis. It includes  the following predictors: Foreign. direct investment, Population, Official.development.assistance, Inflation, Gross.capital.formation,Immunization..measles., Agricultural.land, Exports.of.goods.and.services, Life expectancy and Industry. I created a linear model with these predictors and included an interaction term of Foreign Direct Investement. I wanted to observe if adding this interaction term the explanatory variables would help my model. Plot wise, the historgram of the residuals displays an normal distribution. The residual plot suggests that they points are random and show no signs of autocorrelation nor heteroskedasticity. My linear model yielded a value of 0.8578 for the adjusted R^2 squared term which shows that the model is a good fit for the line represents 86% of the data. However, this is not nearly as good as my first model. When conducting both my Shapiro-Wilk and NCV tests, I yielded high p-values being 0.4363 and 0.773 respectively, which suggest that the data is normal and not heteroskedastic. I believe that this is the best the best model of the 4.











2). In order to determine what variable is the best for gathering information on  economic growth, I would say that we need to look at the variables concering GDP and GNI. The variables I would pick out of them all are GDP, GDP.growth, GNI.per.capita, and GNI.

3). The variables that I would expect to have the most influence economic growth are Industry, Inflation, Long.term.debt, and Foreign.direct.investment. For Industry I expect to see a positive correlation between that factor and GDP.growth. For Inflation, I expect to see a negative correlation between Inflation and GDP.growth. For Long.term.debt, I expect to see a negative correlation between Long.term.debt and GDP.growth. Finally for Foreign.direct.investment I expect to see a positive correlation between Foreign.direct.investment and GDP.growth.

4). Some missing factors that could have direct effect on the model but not included in the model can be the unemployment rate in the country and the rate of jobs openings in terms of the creation of companies.

5). Variables such as fertility, life expectancy and CO2 emissions may invlove unwanted variablity in terms of the units they are measured in. The way of collecting that data may be on a scale that is very differnt than the scale we use to measure other variables and can effect our data in a way that is not representative of what is going on. We must be able to quantify all information so that it all is relatable and provide reliable variability. The same goes for other variables such as peronal computers, and internet users. How do we measure those varialbes in a way that would yeild accurate variablity among the interaction between variables.

6). The conditions that would be conserdered typical for this modle of study would be inflation, Net barter, Exports of Goods and services, Foreign Direct Investment, Long term deby, Military expendature, Merchandise trade.

7). The answer to seven is above in my graphs.

Conclusion:

In order to observe what explains economic development, I had to strategetically choose my explanatory and response variables. I used stepwise regression which is that semi automated process of building a model by successively adding or removing variables based solely on the t-statistics of their estimated coefficients. These variables had to be representative of what I wanted to find. For my response variable I chose GDP.growth to analyze the rate of growth in Gross Demoestic Product and I choose Foreign. direct investment, Population, Official.development.assistance, Inflation, Gross.capital.formation,Immunization..measles., Agricultural.land, Exports.of.goods.and.services, Life expectancy and Industry for my explanatory variables. Using the stepwise regression method I fouond that these were the best variables to used because they explaned most of the data. With these predictor variables, I manipulated them by squaring them, taking the log, and adding an interaction variable. What I found out was that taking the log and squaring them did not help my model but adding the interaction variable did. My R^2 value for the interaction model was 0.85 which meant that 85 percent of the data was explained by those varables. Also my residual plots were random showing no signs of autocorrelation and heteroskadasticity. Also my ncv and Shapiro tests had high p-values suggesting that my data is normally distributed and that there was no heteroskidasticity. In the future the data we might need or might be useful is the unemployment rate and labor force participation rate. I beleive that this variables would heavily impact our data and that may these variables can explain more of our data.




1. An attempt to add a quadratic variable with analysis
2.An attempt at an interaction term with analysis multiply to predictors together.
3. A prediction confidence interval for some input and what that means
4. An explanation of what you have learned from the model. What do the coefficients, r^2, step wise regression, etc.. tell you about the problem
5. A discussion of what data you might need in the future.

ALL OF THE QUESTIONS ABOVE HAVE BEEN ADDRESSED AND THE CONFIDENCE INTERVAL IS WITHIN THE FIRST MODEL.


